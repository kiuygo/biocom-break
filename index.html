<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BIOCOM - Balance Total</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;600&display=swap');

        :root {
            --biocom-blue: #234769;
            --biocom-green: #3b8c47;
            --amber: #d97706;
            --bg: #eef2f7;
            --card: #ffffff;
            --text: #1f2a37;
            --muted: #5b6b7c;
            --border: #d6dee8;
            --shadow: 0 18px 40px -22px rgba(15, 23, 42, 0.35);
            --glow: 0 0 0 4px rgba(59, 140, 71, 0.12);
            --radius-xl: 20px;
            --radius-lg: 14px;
            --radius-md: 10px;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Space Grotesk', system-ui, -apple-system, Segoe UI, sans-serif;
            background:
                radial-gradient(1000px 420px at 20% -10%, #dbeafe 0%, rgba(219, 234, 254, 0) 70%),
                radial-gradient(900px 500px at 110% 0%, #dcfce7 0%, rgba(220, 252, 231, 0) 70%),
                var(--bg);
            color: var(--text);
            margin: 0;
            padding: 16px 12px 28px;
            min-height: 100vh;
        }

        .container {
            max-width: 640px;
            margin: 0 auto;
            background: var(--card);
            padding: 18px;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow);
            border: 1px solid rgba(148, 163, 184, 0.25);
            position: relative;
            overflow: hidden;
        }

        /* HEADER */
        .logo-area {
            text-align: center;
            margin-bottom: 18px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(148, 163, 184, 0.4);
        }

        .logo-img {
            max-width: 150px;
            height: auto;
            filter: drop-shadow(0 6px 12px rgba(15, 23, 42, 0.12));
        }

        .app-title {
            font-size: 0.9rem;
            color: var(--biocom-blue);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-top: 6px;
        }

        /* GRILLA DE DOS COLUMNAS */
        .columns-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .column {
            background: linear-gradient(160deg, #f8fafc 0%, #eef2f7 100%);
            padding: 10px;
            border-radius: var(--radius-lg);
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            gap: 6px;
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.8);
        }

        .col-title {
            text-align: center;
            font-weight: 700;
            color: white;
            padding: 7px 6px;
            border-radius: var(--radius-md);
            margin-bottom: 2px;
            font-size: 0.85rem;
            letter-spacing: 0.6px;
        }

        .t-s1 {
            background: linear-gradient(135deg, #234769 0%, #2f5d89 100%);
        }

        .t-s2 {
            background: linear-gradient(135deg, #d97706 0%, #f59e0b 100%);
        }

        /* Naranja quemado para mejor contraste */

        .input-group {
            margin-bottom: 6px;
        }

        label {
            display: block;
            font-size: 0.72rem;
            font-weight: 600;
            margin-bottom: 4px;
            color: var(--muted);
        }

        input {
            width: 100%;
            padding: 9px 6px;
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            font-size: 1rem;
            text-align: center;
            inputmode: decimal;
            color: #0f172a;
            font-weight: 600;
            background: #ffffff;
            transition: border-color 0.15s ease, box-shadow 0.15s ease, transform 0.15s ease;
        }

        input:focus {
            border-color: var(--biocom-green);
            box-shadow: var(--glow);
            outline: none;
            transform: translateY(-1px);
        }

        .sub-label {
            font-size: 0.65rem;
            text-align: center;
            color: #8a97a8;
            margin: 6px 0 2px 0;
            font-weight: 700;
            letter-spacing: 1px;
        }

        /* PANELES DE RESUMEN INDIVIDUAL (NUEVO) */
        .mini-summary {
            background: #e9eef6;
            border-radius: var(--radius-md);
            padding: 8px;
            margin-top: auto;
            font-size: 0.76rem;
            border: 1px dashed rgba(100, 116, 139, 0.4);
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
            color: #445266;
        }

        .summary-total {
            margin-top: 6px;
            padding-top: 6px;
            border-top: 1px solid rgba(100, 116, 139, 0.35);
            text-align: center;
        }

        .summary-val {
            font-weight: 700;
            font-family: 'IBM Plex Mono', ui-monospace, SFMono-Regular, Menlo, monospace;
        }

        .cash-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            font-weight: 700;
            color: var(--biocom-blue);
        }

        .cash-value {
            font-size: 1.15rem;
            font-weight: 900;
            color: var(--biocom-blue);
            display: block;
            font-family: 'IBM Plex Mono', ui-monospace, SFMono-Regular, Menlo, monospace;
        }

        /* BOTON Y RESULTADO FINAL */
        #result-card {
            margin-top: 16px;
            padding: 16px;
            background: #dcfce7;
            border: 2px solid var(--biocom-green);
            border-radius: var(--radius-lg);
            text-align: center;
            display: none;
            animation: rise 0.2s ease-out;
        }

        .who-pays {
            font-size: 1.05rem;
            font-weight: 700;
            color: var(--biocom-blue);
            margin-bottom: 6px;
            line-height: 1.25;
        }

        .amount {
            font-size: 2.4rem;
            font-weight: 900;
            color: var(--biocom-green);
            line-height: 1;
            font-family: 'IBM Plex Mono', ui-monospace, SFMono-Regular, Menlo, monospace;
        }

        .btn-reset {
            width: 100%;
            background: linear-gradient(135deg, #1f3c58 0%, #2e5d89 100%);
            color: #ffffff;
            border: none;
            border-radius: var(--radius-lg);
            padding: 14px;
            font-size: 1.05rem;
            font-weight: 700;
            cursor: pointer;
            margin-top: 12px;
            box-shadow: 0 16px 30px -20px rgba(30, 58, 92, 0.9);
            transition: transform 0.12s ease, box-shadow 0.2s ease, filter 0.2s ease;
        }

        .btn-reset:hover {
            filter: brightness(1.02);
            box-shadow: 0 20px 36px -20px rgba(30, 58, 92, 0.9);
        }

        .btn-reset:active {
            transform: translateY(1px) scale(0.99);
        }

        @keyframes rise {
            from {
                transform: translateY(6px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @media (max-width: 640px) {
            .columns-wrapper {
                grid-template-columns: 1fr;
            }

            .container {
                padding: 14px;
            }
        }
    </style>
</head>

<body>

    <div class="container">
        <div class="logo-area">
            <img src="logo.png" alt="BIOCOM" class="logo-img">
            <div class="app-title">Control de Break & Caja</div>
        </div>

        <div class="columns-wrapper">
            <div class="column">
                <div class="mini-summary">
                    <div class="summary-row">
                        <span>Venta GNV:</span>
                        <span class="summary-val" id="res_s1_gnv">0.00</span>
                    </div>
                    <div class="summary-row">
                        <span>Venta POS:</span>
                        <span class="summary-val" id="res_s1_pos">0.00</span>
                    </div>
                    <div class="summary-total">
                        <div class="cash-label">EFECTIVO CAJA S1</div>
                        <span class="cash-value" id="res_s1_cash">0.00</span>
                    </div>
                </div>

                <div class="col-title t-s1">SURTIDOR 1</div>

                <div class="sub-label">--- COMBUSTIBLE ---</div>
                <div class="input-group">
                    <label>Inicial</label>
                    <input type="number" id="s1_ini" placeholder="0">
                </div>
                <div class="input-group">
                    <label>Final</label>
                    <input type="number" id="s1_fin" placeholder="0">
                </div>

                <div class="sub-label">--- POS / YAPE ---</div>
                <div class="input-group">
                    <label>Inicial</label>
                    <input type="number" id="p1_ini" placeholder="0">
                </div>
                <div class="input-group">
                    <label>Final</label>
                    <input type="number" id="p1_fin" placeholder="0">
                </div>
            </div>

            <div class="column">
                <div class="mini-summary">
                    <div class="summary-row">
                        <span>Venta GNV:</span>
                        <span class="summary-val" id="res_s2_gnv">0.00</span>
                    </div>
                    <div class="summary-row">
                        <span>Venta POS:</span>
                        <span class="summary-val" id="res_s2_pos">0.00</span>
                    </div>
                    <div class="summary-total">
                        <div class="cash-label">EFECTIVO CAJA S2</div>
                        <span class="cash-value" id="res_s2_cash">0.00</span>
                    </div>
                </div>

                <div class="col-title t-s2">SURTIDOR 2</div>

                <div class="sub-label">--- COMBUSTIBLE ---</div>
                <div class="input-group">
                    <label>Inicial</label>
                    <input type="number" id="s2_ini" placeholder="0">
                </div>
                <div class="input-group">
                    <label>Final</label>
                    <input type="number" id="s2_fin" placeholder="0">
                </div>

                <div class="sub-label">--- POS / YAPE ---</div>
                <div class="input-group">
                    <label>Inicial</label>
                    <input type="number" id="p2_ini" placeholder="0">
                </div>
                <div class="input-group">
                    <label>Final</label>
                    <input type="number" id="p2_fin" placeholder="0">
                </div>
            </div>
        </div>

        <div id="result-card">
            <div class="who-pays" id="texto-resultado">...</div>
            <div class="amount" id="monto-resultado">S/ 0.00</div>
        </div>

        <button class="btn-reset" onclick="limpiar()">NUEVA OPERACIÓN</button>
    </div>

    <script>
        function getVal(id) {
            const v = document.getElementById(id).value;
            return v === "" ? 0 : parseFloat(v);
        }

        function setTxt(id, val) {
            document.getElementById(id).innerText = val.toFixed(2);
        }

        function actualizarResumenes() {
            // --- CALCULOS SURTIDOR 1 ---
            const s1_gnv = getVal('s1_fin') - getVal('s1_ini');
            const s1_pos = getVal('p1_fin') - getVal('p1_ini');
            const s1_cash = s1_gnv - s1_pos;

            // Actualizar panel S1
            setTxt('res_s1_gnv', s1_gnv);
            setTxt('res_s1_pos', s1_pos);
            setTxt('res_s1_cash', s1_cash);

            // --- CALCULOS SURTIDOR 2 ---
            const s2_gnv = getVal('s2_fin') - getVal('s2_ini');
            const s2_pos = getVal('p2_fin') - getVal('p2_ini');
            const s2_cash = s2_gnv - s2_pos;

            // Actualizar panel S2
            setTxt('res_s2_gnv', s2_gnv);
            setTxt('res_s2_pos', s2_pos);
            setTxt('res_s2_cash', s2_cash);
        }

        function calcularTodo({ silent = false } = {}) {
            // Mantener paneles actualizados siempre
            actualizarResumenes();

            const s1_gnv = getVal('s1_fin') - getVal('s1_ini');
            const s1_pos = getVal('p1_fin') - getVal('p1_ini');
            const s1_cash = s1_gnv - s1_pos;

            const s2_gnv = getVal('s2_fin') - getVal('s2_ini');
            const s2_pos = getVal('p2_fin') - getVal('p2_ini');
            const s2_cash = s2_gnv - s2_pos;

            // --- VALIDACIONES BASICAS ---
            if (!silent && (s1_gnv < 0 || s2_gnv < 0)) {
                alert("¡Cuidado! Hay lecturas finales menores a las iniciales en el combustible.");
                return;
            }
            if (!silent && (s1_cash < 0 || s2_cash < 0)) {
                alert("Alerta: El efectivo sale negativo en uno de los surtidores. Revisa si la venta POS es mayor a la venta total.");
            }

            // --- CRUCE FINAL (NETTING) ---
            // El Trabajador del S2 tiene el Cash del S1 (s1_cash)
            // El Trabajador del S1 tiene el Cash del S2 (s2_cash)

            const diferencia = s1_cash - s2_cash;
            const montoFinal = Math.abs(diferencia).toFixed(2);

            const resultCard = document.getElementById('result-card');
            const textoRes = document.getElementById('texto-resultado');
            const montoRes = document.getElementById('monto-resultado');

            if (diferencia > 0) {
                // S1 generó más efectivo (que tiene S2). S2 paga la diferencia.
                textoRes.innerHTML = "SURTIDOR 2 <br>paga a SURTIDOR 1";
                resultCard.style.background = "#dcfce7";
                resultCard.style.borderColor = "#22c55e";
            } else if (diferencia < 0) {
                // S2 generó más efectivo (que tiene S1). S1 paga la diferencia.
                textoRes.innerHTML = "SURTIDOR 1 <br>paga a SURTIDOR 2";
                resultCard.style.background = "#dbeafe";
                resultCard.style.borderColor = "#3b82f6";
            } else {
                textoRes.innerHTML = "CUENTAS SALDADAS";
                montoRes.innerText = "S/ 0.00";
                resultCard.style.background = "#f1f5f9";
                resultCard.style.borderColor = "#cbd5e1";
                resultCard.style.display = "block";
                return;
            }

            montoRes.innerText = "S/ " + montoFinal;
            resultCard.style.display = "block";
        }

        function limpiar() {
            document.querySelectorAll('input').forEach(i => i.value = '');
            document.querySelectorAll('.summary-val, .cash-value').forEach(s => s.innerText = '0.00');
            document.getElementById('result-card').style.display = 'none';
            window.scrollTo(0, 0);
        }

        // Auto-suma mientras se ingresan datos (sin alertas)
        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('input', () => calcularTodo({ silent: true }));
        });

        // Inicializar paneles en carga
        actualizarResumenes();
    </script>
</body>

</html>
